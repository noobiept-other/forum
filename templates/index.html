{% extends "base.html" %}

{% block content %}

{% if user.is_moderator %}
    <ul>
        <li>New category.</li>
    </ul>
{% endif %}

{% if categories %}

    {% for category in categories %}

        <h2>{{ category.name }}</h2>
        {% if category.subforum %}
            <table>
            {% for subforum in category.subforum %}
                <tr>
                    <td><a href="{{ subforum.url }}">{{ subforum.name }}</a></td>
                    <td>threads: {{ subforum.threads_count }}</td>
                    <td>latest post:
                        {% if subforum.last_post %}
                            <a href="{{ subforum.last_post.get_url }}">{{ subforum.last_post.text|truncatechars:10 }}</a> by <a href="{{ subforum.last_post.user.profile.get_url }}">{{ subforum.last_post.user }}</a>
                        {% else %}
                            ---
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </table>
        {% else %}
            <p>No sub-forums.</p>
        {% endif %}

    {% endfor %}

{% else %}

    <p>No categories.</p>

{% endif %}
{% endblock %}